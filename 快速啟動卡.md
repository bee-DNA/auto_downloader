# 🚀 快速啟動卡 - 新環境使用

## 📦 移至新環境

1. **複製整個 `auto_downloader` 資料夾**（104 MB）
2. 確認新電腦有：
   - ✅ Windows 10/11
   - ✅ **Python 3.7+**（⚠️ **需手動安裝並加入 PATH**）
     - 下載：https://www.python.org/downloads/
     - 推薦：Python 3.10、3.11 或 3.12
   - ✅ 網路連線
   - ✅ D: 磁碟至少 240 GB 空間

---

## ⚡ 啟動步驟

### 步驟 0️⃣: 安裝 SRA Toolkit（如果沒有）

```powershell
cd auto_downloader

# 檢查是否已有
dir sratoolkit.3.2.1-win64\bin\prefetch.exe

# 如果沒有，一鍵安裝
一鍵安裝_SRA_Toolkit.bat
```

⏱️ 約 2-3 分鐘（自動下載 60 MB）

---

### 步驟 1️⃣: 解除封鎖（⚠️ 重要）

```powershell
powershell -ExecutionPolicy Bypass -File 解除封鎖_SRA_Toolkit.ps1
```

**必須！** Windows 會封鎖下載的檔案  
⏱️ 約 10 秒  
**💡 自動安裝會自動解除封鎖**

---

### 步驟 2️⃣: 初始化（首次必須）

```powershell
.\SETUP.bat
```

**會自動安裝 Python 套件**: `paramiko`、`tqdm`  
**或提示安裝 toolkit**（如果沒有）  
⏱️ 約 2-3 分鐘

---

### 步驟 3️⃣: 開始下載

```powershell
.\START.bat
```

**自動下載 257 個樣本**（跳過 NAS 已有的 114 個）  
⏱️ 約 28 小時

---

## 📊 系統會自動完成

- ✅ 從 NCBI 下載 SRA
- ✅ 解壓為 FASTQ（6 個並行 × 5 線程）
- ✅ 上傳到 NAS (`bioailab.synology.me`)
- ✅ 清理本地暫存檔
- ✅ 記錄進度到 `download_progress.json`

---

## 🔧 需要手動安裝 Python 套件？

如果 SETUP.bat 失敗，手動執行：

```powershell
pip install paramiko tqdm
```

驗證安裝：

```powershell
python check_environment.py
```

---

## 📈 監控進度

**查看終端輸出**:

```
🔄 [15/257] 處理 SRR12345678...
  ⏬ Prefetch: 2.5 GB | 進度: 80%
  🧬 Fasterq-dump: 解壓中 (5線程)
  ☁️ 上傳完成
✅ [15/257] 完成！
```

**檢查進度檔案**:

```powershell
notepad download_progress.json
```

---

## ⚠️ 常見問題

| 問題                  | 解決方法                              |
| --------------------- | ------------------------------------- |
| **prefetch 無法執行** | 🔴 **先執行步驟 1 解除封鎖！**        |
| Python 找不到         | 安裝 Python 並加入 PATH               |
| pip 失敗              | `python -m pip install --upgrade pip` |
| 無法連接 NAS          | 檢查網路和防火牆（埠 10022）          |
| 磁碟空間不足          | 確保 D: 有 240 GB 可用                |

**如果步驟 1 後仍失敗**:

```powershell
# 執行診斷工具
診斷_SRA_Toolkit.bat

# 或查看完整指南
notepad SRA_Toolkit故障排除指南.md
```

---

## 📂 下載統計

```
總樣本數: 606 個
├── 處理中: 371 個 SRR
│   ├── ✅ NAS 已完成: 114 個（跳過）
│   └── ⏳ 需下載: 257 個 ← 只下載這些
└── 跳過: 235 個 ERR/DRR
```

---

## 🎯 最簡流程

**如果已有 toolkit**:

1. `powershell -ExecutionPolicy Bypass -File 解除封鎖_SRA_Toolkit.ps1` ← 解除封鎖
2. `.\SETUP.bat` ← 安裝套件
3. `.\START.bat` ← 開始下載

**如果沒有 toolkit**:

1. `一鍵安裝_SRA_Toolkit.bat` ← 自動下載安裝（會自動解除封鎖）
2. `.\SETUP.bat` ← 安裝套件
3. `.\START.bat` ← 開始下載

**或使用 SETUP.bat 智能安裝**:

- 執行 `SETUP.bat` 會自動檢測並提示安裝 toolkit

**完整說明**: 見 `新環境啟動指南.md` 📖  
**故障排除**: 見 `SRA_Toolkit故障排除指南.md` 🔧
