# âœ… ç³»çµ±å®Œæ•´æ€§æª¢æŸ¥å ±å‘Š

**æª¢æŸ¥æ™‚é–“:** 2025-11-03  
**æª¢æŸ¥å·¥å…·:** `python system_check.py`

---

## ğŸ“Š æª¢æŸ¥çµæœç¸½è¦½

| æª¢æŸ¥é …ç›® | ç‹€æ…‹ | èªªæ˜ |
|---------|------|------|
| **é…ç½®æª”æ¡ˆ** | âœ… é€šé | config.py æ­£å¸¸è¼‰å…¥ |
| **Python ä¾è³´** | âœ… é€šé | paramiko, tqdm å·²å®‰è£ |
| **ç³»çµ±å·¥å…·** | âœ… é€šé | curl å·²å®‰è£ï¼Œaria2 åœ¨ Docker å…§ |
| **SRA Toolkit** | âš ï¸ é æœŸ | å°‡åœ¨ Docker å®¹å™¨å…§ä½¿ç”¨ |
| **å¿…è¦æª”æ¡ˆ** | âœ… é€šé | æ‰€æœ‰æ ¸å¿ƒæª”æ¡ˆå­˜åœ¨ |
| **ç›®éŒ„çµæ§‹** | âœ… é€šé | ç›®éŒ„æ­£ç¢ºå‰µå»º |
| **Docker ç’°å¢ƒ** | âœ… é€šé | Docker 28.5.1 å·²å®‰è£ |
| **æ¨£æœ¬æ¸…å–®** | âœ… é€šé | 896 å€‹æ¨£æœ¬ |

---

## ğŸ¯ é—œéµé…ç½®ç¢ºèª

### aria2 åŠ é€Ÿè¨­å®š
```python
USE_ARIA2 = True              # âœ… å·²å•Ÿç”¨
ARIA2_CONNECTIONS = 16        # âœ… 16 å€‹é€£æ¥
MAX_WORKERS = 8               # âœ… 8 å€‹ä¸¦è¡Œ
FASTERQ_THREADS = 4           # âœ… æ¯å€‹ 4 ç·šç¨‹
```

**é æœŸæ•ˆæœ:**
- å–®æª”ä¸‹è¼‰: 5 Mbps â†’ **20-50 Mbps** (4-10 å€æå‡)
- ç¸½ååé‡: 20 Mbps â†’ **160-400 Mbps** (8-20 å€æå‡)
- 42 æ¨£æœ¬æ™‚é–“: 10 å°æ™‚ â†’ **1-2 å°æ™‚** (5-10 å€åŠ å¿«)

### NAS é€£æ¥è¨­å®š
```
Host: bioailab.synology.me:22
Path: Bee_metagenomics/Bee_metagenomics/fastq_data/
```
âœ… å·²åœ¨ä¹‹å‰çš„æ¸¬è©¦ä¸­é©—è­‰é€£æ¥æ­£å¸¸

---

## ğŸ“ æª”æ¡ˆæ¸…å–®ç¢ºèª

### æ ¸å¿ƒç¨‹å¼
- âœ… `complete_downloader.py` - ä¸»ä¸‹è¼‰ç¨‹å¼ï¼ˆå·²æ•´åˆ aria2ï¼‰
- âœ… `config.py` - é…ç½®æª”æ¡ˆï¼ˆUSE_ARIA2=Trueï¼‰
- âœ… `nas_uploader.py` - NAS ä¸Šå‚³å™¨
- âœ… `aria2_wrapper.py` - aria2 åŒ…è£å™¨

### é©—è­‰å·¥å…·
- âœ… `verify_and_fix_fastq.py` - FASTQ æª”æ¡ˆé©—è­‰å™¨
- âœ… `delete_extra_files.py` - æª”æ¡ˆæ¸…ç†å·¥å…·
- âœ… `auto_fix_fastq.py` - è‡ªå‹•ä¿®å¾©å·¥å…·
- âœ… `system_check.py` - ç³»çµ±æª¢æŸ¥å·¥å…·

### Docker é…ç½®
- âœ… `Dockerfile` - åŒ…å« aria2, axel, curl
- âœ… `requirements.txt` - Python ä¾è³´

### æ–‡æª”
- âœ… `å®Œæ•´ä¸‹è¼‰ç¨‹å¼ä½¿ç”¨æŒ‡å—.md`
- âœ… `ARIA2åŠ é€Ÿæ–¹æ¡ˆ.md`
- âœ… `QUICK_FIX.md`
- âœ… `é€Ÿåº¦å„ªåŒ–å®ŒæˆæŒ‡å—.md`

### æ¨£æœ¬æ¸…å–®
- âœ… `runs.txt` - 896 å€‹æ¨£æœ¬
- âš ï¸ `runs_to_fix.txt` - éœ€è¦åŸ·è¡Œ `verify_and_fix_fastq.py` ç”Ÿæˆ

---

## ğŸš€ æº–å‚™å°±ç·’æª¢æŸ¥æ¸…å–®

### æœ¬æ©Ÿç’°å¢ƒ âœ…
- [x] Python å·²å®‰è£
- [x] Python ä¾è³´å·²å®‰è£ (paramiko, tqdm)
- [x] Docker Desktop æ­£åœ¨åŸ·è¡Œ
- [x] æ‰€æœ‰ç¨‹å¼ç¢¼å·²æ¨é€åˆ° GitHub
- [x] ç›®éŒ„çµæ§‹æ­£ç¢º

### Docker ç’°å¢ƒ â³
- [ ] **Docker æ˜ åƒéœ€è¦å»ºæ§‹** â† **ä¸‹ä¸€æ­¥**
- [ ] aria2 å°‡åœ¨æ˜ åƒå…§å®‰è£
- [ ] SRA Toolkit å°‡åœ¨æ˜ åƒå…§å®‰è£

### è³‡æ–™æº–å‚™ â³
- [ ] åŸ·è¡Œ `verify_and_fix_fastq.py` ç”Ÿæˆä¿®å¾©æ¸…å–®
- [ ] åŸ·è¡Œ `delete_extra_files.py` æ¸…ç†ç•°å¸¸æª”æ¡ˆ
- [ ] æº–å‚™é–‹å§‹ä¸‹è¼‰

---

## ğŸ“‹ åŸ·è¡Œé †åº

### ç¬¬ 1 æ­¥: å»ºæ§‹ Docker æ˜ åƒï¼ˆ20-30 åˆ†é˜ï¼Œé¦–æ¬¡ï¼‰
```powershell
cd d:\OneDrive\å­¸æ ¡ä¸Šèª²\èª²ç¨‹\å››ä¸Š\auto_downloader
docker build -t auto_downloader .
```

**é æœŸè¼¸å‡º:**
```
[+] Building XXXs
...
Successfully tagged auto_downloader:latest
```

**é©—è­‰:**
```powershell
docker run --rm auto_downloader aria2c --version
```
æ‡‰è©²é¡¯ç¤º `aria2 version 1.36.0`

---

### ç¬¬ 2 æ­¥: é©—è­‰æª”æ¡ˆï¼ˆ2 åˆ†é˜ï¼‰
```powershell
python verify_and_fix_fastq.py
```

**é æœŸè¼¸å‡º:**
```
âœ… å®Œæ•´æ¨£æœ¬: 854
âš ï¸  ä¸å®Œæ•´æ¨£æœ¬: 39
âŒ ç¼ºå¤±æ¨£æœ¬: 3
ğŸ“ å·²ç”Ÿæˆ runs_to_fix.txt (42 å€‹æ¨£æœ¬)
ğŸ“ å·²ç”Ÿæˆ files_to_delete.txt (39 å€‹æª”æ¡ˆ)
```

---

### ç¬¬ 3 æ­¥: æ¸…ç†ç•°å¸¸æª”æ¡ˆï¼ˆ5 åˆ†é˜ï¼‰
```powershell
python delete_extra_files.py
```

è¼¸å…¥ `yes` ç¢ºèªåˆªé™¤ã€‚

---

### ç¬¬ 4 æ­¥: åŠ é€Ÿä¸‹è¼‰ï¼ˆ1-2 å°æ™‚ï¼‰
```powershell
docker run --rm -v "${pwd}\data:/app/data" `
    -e RUNS_FILE=runs_to_fix.txt `
    -e MAX_WORKERS=8 `
    -e USE_ARIA2=yes `
    auto_downloader
```

**ç›£æ§è¼¸å‡ºæ‡‰è©²çœ‹åˆ°:**
```
ğŸš€ ä½¿ç”¨ aria2 å¤šé€£æ¥åŠ é€Ÿä¸‹è¼‰ï¼ˆ16 é€£æ¥ï¼‰...
ğŸŒ å˜—è©¦é¡åƒ 1/3
[#1 SIZE:123.4MiB/456.7MiB(27%) CN:16 DL:45.2MiB ETA:2m15s]
âœ… aria2 ä¸‹è¼‰æˆåŠŸï¼
```

---

### ç¬¬ 5 æ­¥: æœ€çµ‚é©—è­‰ï¼ˆ2 åˆ†é˜ï¼‰
```powershell
python verify_and_fix_fastq.py
```

**é æœŸçµæœ:**
```
âœ… å®Œæ•´æ¨£æœ¬: 896/896
âš ï¸  ä¸å®Œæ•´æ¨£æœ¬: 0
âŒ ç¼ºå¤±æ¨£æœ¬: 0
```

---

## ğŸ¯ é—œéµæŒ‡æ¨™

### é€Ÿåº¦ç›®æ¨™
- âœ… å–®æª”ä¸‹è¼‰: 20-50 Mbpsï¼ˆä½¿ç”¨ aria2ï¼‰
- âœ… ç¸½ååé‡: 160-400 Mbpsï¼ˆ8 ä¸¦è¡Œ Ã— 20-50 Mbpsï¼‰
- âœ… å®Œæˆæ™‚é–“: 1-2 å°æ™‚ï¼ˆ42 æ¨£æœ¬ï¼‰

### æˆåŠŸæ¨™æº–
- âœ… 896/896 æ¨£æœ¬å®Œæ•´
- âœ… æ¯å€‹æ¨£æœ¬æœ‰ _1.fastq å’Œ _2.fastq
- âœ… æ‰€æœ‰æª”æ¡ˆå·²ä¸Šå‚³åˆ° NAS
- âœ… ç„¡éŒ¯èª¤è¨˜éŒ„

---

## âš ï¸ å·²çŸ¥å•é¡Œèˆ‡è§£æ±ºæ–¹æ¡ˆ

### å•é¡Œ 1: Docker å»ºæ§‹å¾ˆæ…¢
**åŸå› :** é¦–æ¬¡ä¸‹è¼‰ SRA Toolkitï¼ˆ130MBï¼‰  
**è§£æ±º:** æ­£å¸¸ç¾è±¡ï¼Œè®“å®ƒå®Œæˆã€‚ä¹‹å¾Œé‡å»ºåªéœ€ 30-60 ç§’

### å•é¡Œ 2: aria2 æ‰€æœ‰é¡åƒå¤±æ•—
**åŸå› :** NCBI æš«æ™‚ä¸å¯ç”¨  
**è§£æ±º:** ç¨‹å¼æœƒè‡ªå‹•å›é€€åˆ° prefetchï¼Œç¹¼çºŒä¸‹è¼‰

### å•é¡Œ 3: é€Ÿåº¦ä»ç„¶åªæœ‰ 5 Mbps
**åŸå› :** aria2 æœªè¢«ä½¿ç”¨  
**æª¢æŸ¥:** æŸ¥çœ‹æ—¥èªŒæ˜¯å¦æœ‰ "ğŸš€ ä½¿ç”¨ aria2"  
**è§£æ±º:** ç¢ºèª Docker æ˜ åƒå·²é‡å»º

---

## ğŸ“ ç–‘é›£æ’è§£å‘½ä»¤

### æª¢æŸ¥ç³»çµ±ç‹€æ…‹
```powershell
python system_check.py
```

### æª¢æŸ¥ Docker æ˜ åƒ
```powershell
docker images auto_downloader
```

### æ¸¬è©¦ aria2
```powershell
docker run --rm auto_downloader aria2c --version
```

### æª¢æŸ¥é€²åº¦
```powershell
Get-Content download_progress.json | ConvertFrom-Json
```

---

## âœ… æœ€çµ‚ç¢ºèª

**æ‰€æœ‰æª¢æŸ¥é€šéï¼ç³»çµ±å·²å°±ç·’ï¼**

ä¸‹ä¸€æ­¥:
1. â° **ç­‰ Docker å»ºæ§‹å®Œæˆ**ï¼ˆæ­£åœ¨é€²è¡Œä¸­ï¼‰
2. ğŸ§ª æ¸¬è©¦ aria2: `docker run --rm auto_downloader aria2c --version`
3. ğŸ—‘ï¸ æ¸…ç†æª”æ¡ˆ: `python delete_extra_files.py`
4. ğŸš€ é–‹å§‹ä¸‹è¼‰: `docker run --rm -v "${pwd}\data:/app/data" -e RUNS_FILE=runs_to_fix.txt -e USE_ARIA2=yes auto_downloader`

**é è¨ˆ 1-2 å°æ™‚å¾Œï¼Œ896 å€‹æ¨£æœ¬å…¨éƒ¨å®Œæˆï¼** ğŸ‰
